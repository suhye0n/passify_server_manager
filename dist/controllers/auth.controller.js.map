{"version":3,"sources":["../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from 'express';\nimport { Container } from 'typedi';\nimport { CreateUserDto } from '@dtos/users.dto';\nimport { User } from '@interfaces/users.interface';\nimport { RequestWithUser } from '@interfaces/auth.interface';\nimport { AuthService } from '@services/auth.service';\n\nexport class AuthController {\n  private authService = Container.get(AuthService);\n\n  public signUp = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const newUser: CreateUserDto = req.body;\n      const { cookie, user } = await this.authService.signup(newUser);\n      res.setHeader('Set-Cookie', [cookie]);\n      res.status(201).json({ data: user, message: 'signup' });\n    } catch (error) {\n      next(error);\n    }\n  };\n\n  public logIn = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const credentials: CreateUserDto = req.body;\n      const { cookie, user } = await this.authService.login(credentials);\n      res.setHeader('Set-Cookie', [cookie]);\n      res.status(200).json({ data: user, message: 'login' });\n    } catch (error) {\n      next(error);\n    }\n  };\n\n  public logOut = async (req: RequestWithUser, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const currentUser: User = req.user;\n      const loggedOutUser: User = await this.authService.logout(currentUser);\n      res.setHeader('Set-Cookie', ['Authorization=; Max-age=0']);\n      res.status(200).json({ data: loggedOutUser, message: 'logout' });\n    } catch (error) {\n      next(error);\n    }\n  };\n}\n"],"names":["AuthController","authService","Container","get","AuthService","signUp","req","res","next","newUser","body","cookie","user","signup","setHeader","status","json","data","message","error","logIn","credentials","login","logOut","currentUser","loggedOutUser","logout"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBANa;6BAIE;;;;;;;;;;;;;;AAErB,IAAA,AAAMA,iBAAN,MAAMA;;QACX,uBAAQC,eAAcC,iBAAS,CAACC,GAAG,CAACC,wBAAW;QAE/C,uBAAOC,UAAS,OAAOC,KAAcC,KAAeC;YAClD,IAAI;gBACF,MAAMC,UAAyBH,IAAII,IAAI;gBACvC,MAAM,EAAEC,MAAM,EAAEC,IAAI,EAAE,GAAG,MAAM,IAAI,CAACX,WAAW,CAACY,MAAM,CAACJ;gBACvDF,IAAIO,SAAS,CAAC,cAAc;oBAACH;iBAAO;gBACpCJ,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAML;oBAAMM,SAAS;gBAAS;YACvD,EAAE,OAAOC,OAAO;gBACdX,KAAKW;YACP;QACF;QAEA,uBAAOC,SAAQ,OAAOd,KAAcC,KAAeC;YACjD,IAAI;gBACF,MAAMa,cAA6Bf,IAAII,IAAI;gBAC3C,MAAM,EAAEC,MAAM,EAAEC,IAAI,EAAE,GAAG,MAAM,IAAI,CAACX,WAAW,CAACqB,KAAK,CAACD;gBACtDd,IAAIO,SAAS,CAAC,cAAc;oBAACH;iBAAO;gBACpCJ,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAML;oBAAMM,SAAS;gBAAQ;YACtD,EAAE,OAAOC,OAAO;gBACdX,KAAKW;YACP;QACF;QAEA,uBAAOI,UAAS,OAAOjB,KAAsBC,KAAeC;YAC1D,IAAI;gBACF,MAAMgB,cAAoBlB,IAAIM,IAAI;gBAClC,MAAMa,gBAAsB,MAAM,IAAI,CAACxB,WAAW,CAACyB,MAAM,CAACF;gBAC1DjB,IAAIO,SAAS,CAAC,cAAc;oBAAC;iBAA4B;gBACzDP,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMQ;oBAAeP,SAAS;gBAAS;YAChE,EAAE,OAAOC,OAAO;gBACdX,KAAKW;YACP;QACF;;AACF"}